<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Roya_A_1_1</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
<body>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"/>

    <div style="max-width:640px;height:fit-content;margin-left: auto;margin-right: auto;margin-top: 100px;padding: 0px;">

        <div id='place-video' style="width:100%;margin: 0px;padding: 0px;"></div>
        <div id='place-caption' style="width:100%;height:30px;line-height: 30px;vertical-align: middle;background-color: #eeeeee;color:grey;text-align:center;"></div>

         <div class="radio-inline">
            <label style="font-weight: 100;">
                <input type="radio" name="optionRadios" id="radio_en" value="en" checked>
                en
            </label>
        </div>
        <div class="radio-inline">
            <label style="font-weight: 100;">
                <input type="radio" name="optionRadios" id="radio_ko" value="ko">
                ko
            </label>
        </div>
        <div class="radio-inline">
            <label style="font-weight: 100;">
                <input type="radio" name="optionRadios" id="radio_ar" value="ar">
                ar
            </label>
        </div>
        <div class="radio-inline">
            <label style="font-weight: 100;">
                <input type="radio" name="optionRadios" id="radio_no" value="no">
                no caption
            </label>
        </div>
    </div>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone-min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>


    <script>

        var W = $('#place-video').width();
        var H = W*9/16;
        $('#place-video').css('height', H);

        var player, time_update_interval;

        clearInterval(time_update_interval);


        var ClipModel = Backbone.Model.extend({
           default: {
               startTime:0,
               endTime:0,
               en:'',
               ko:'',
               ar:''
           }
        });

        var ClipCollection = Backbone.Collection.extend({
            model:ClipModel ,

            catchClip: function (_Time) {
                var obj = _.filter(this.toJSON(), function(_m) {
                   if (Number(_m.startTime) <= Number(_Time) && Number(_Time) < Number(_m.endTime) ) {
                       return true;
                   } else {
                       return false;
                   }
                });
                return obj;
            }
        });

        // Plase Type Video Information //////////////////////////////////////
        var vInfo = {id: 'yTkwDJHmeYQ', startTime:19, endTime:65};
        //////////////////////////////////////////////////////////////////////

        // Push Clip In Follwing /////////////////////////////////////////////

        var clC = new ClipCollection({})

        var clM1 = new ClipModel({startTime:20, endTime: 30, ko:'네, 뭐! 어떻게 어떻게 어떻게',ar:'أيوة , شو . له له له له '});
        clC.add(clM1);

        var clM2 = new ClipModel({startTime:30, endTime: 35, ko:'아이~~고, 지금 갈께',ar:'لا حول ولا قوة إلا بالله , هيني جاي, هيني جاي '});
        clC.add(clM2);

        var clM3 = new ClipModel({startTime:35, endTime: 40, ko:'아이고 아이고 나의 시어머니, 나의 시어머니' ,ar:'يا خسارتك يا مرتعمي'});
        clC.add(clM3);

        var clM4 = new ClipModel({startTime:40, endTime: 42, ko:'왜! 누가 이렇게 빨리 갈 줄 알았겠어요',ar:'مين قال تتركينا وتروحي '});
        clC.add(clM4);

        var clM5 = new ClipModel({startTime:42, endTime: 43, ko:'드디어',ar:'أخيرا ' });
        clC.add(clM5);

        var clM6 = new ClipModel({startTime:43, endTime: 46, ko:'제 말이, 왜 이렇게 갔어요',ar:'قصدي ..ليش ليش يا مرتعمي'});
        clC.add(clM6);

        var clM7 = new ClipModel({startTime:46, endTime: 47, ko:'(요르단 감탄사), 제가 어머니를 행복하게 해드렸는데',ar:'كنت مهنيتك '});
        clC.add(clM7);

        var clM8 = new ClipModel({startTime:46, endTime: 49, ko:'제가 어머니가 원하는 음식 만들었어요',ar:'والأكلة اللي كنتي بدك إياها أطبخها'});
        clC.add(clM8);

        var clM9 = new ClipModel({startTime:49, endTime: 52, ko:'어머니의 빨래도 항상 깨끗하게 해드렸어요',ar:'وغسيلك دايما نضيف '});
        clC.add(clM9);

        var clM10 = new ClipModel({startTime:52, endTime: 54, ko:'그리고 어머니의 방을 정리하고 깨끗하게 했어요',ar:'وغرفتك مرتبة ونضيفة '});
        clC.add(clM10);

        var clM11 = new ClipModel({startTime:54, endTime: 57, ko:'엄마, 지금 아니야 그말 할 시간',ar:'ماما مش وقته هادا الحكي '});
        clC.add(clM11);

        var clM12 = new ClipModel({startTime:57, endTime: 60, ko:'빨리 x 빨리, 어머니가 가셨어요',ar:'بكير بكير عليكي يا حماتي'});
        clC.add(clM12);

        var clM13 = new ClipModel({startTime:60, endTime: 62, ko:'아직 90세가 아닌데요',ar:'لسه ما وصلتي التسعين '});
        clC.add(clM13);

        //////////////////////////////////////////////////////////////////////

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('place-video', {
                width: W,
                height: H,
                videoId: vInfo.id,
                playerVars: {
                  rel:0,
                  controls: 0,
                  suggestedQuality: 'medium',
                  showinfo: 0
                },
                events: {
                    onReady : function () {
                        player.cueVideoById({
                            videoId: vInfo.id,
                            startSeconds: vInfo.startTime,
                            endSeconds: vInfo.endTime,
                            suggestedQuality:'medium'
                         });

                        clearInterval(time_update_interval);

                        time_update_interval = setInterval(function () {
                            var _Time = player.getCurrentTime();
                            var arrayElem = clC.catchClip(_Time);

                            if (vInfo.endTime == Math.round(_Time)) {
                                player.stopVideo();

                                player.cueVideoById({
                                    videoId: vInfo.id,
                                    startSeconds: vInfo.startTime,
                                    endSeconds: vInfo.endTime,
                                    suggestedQuality:'medium'
                                 });
                            }
                            else if (arrayElem.length != 0) {
                                $('#place-caption').html('');

                                var checked = $( "input:checked" ).val();
                                if (checked == 'ko') {
                                    $('#place-caption').css('direction', 'ltr');
                                    $('#place-caption').html(arrayElem[0].ko);
                                }
                                else if (checked == 'en') {
                                    $('#place-caption').css('direction', 'ltr');
                                    $('#place-caption').html(arrayElem[0].en);
                                }
                                else if (checked == 'ar') {
                                    $('#place-caption').css('direction', 'rtl');
                                    $('#place-caption').html(arrayElem[0].ar);
                                }

                            } else {
                                $('#place-caption').html('');
                            }
                        }, 300);
                    }
                }
            });
        }

    </script>
</body>
</html>
